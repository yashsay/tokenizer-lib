import { Meta } from "@storybook/addon-docs/blocks";

<Meta title="README" />

## Design tokens with Style Dictionary

This repository builds multi-theme design tokens using [Style Dictionary](https://amzn.github.io/style-dictionary) and exposes them as CSS custom properties and ES modules. Tokens live in `src/tokens/` and compile into `dist/tokens/`.

### Token sources

Tokens are split by concern for clarity and scale:

- `src/tokens/primitive.json` — base scales (colors, spacing, radius, typography, etc.) under the top-level key `primitives`.
- `src/tokens/semantic.json` — theme-aware semantic tokens under `semantics.theme_light` and `semantics.theme_dark`.
- `src/tokens/molecules.json` — component/molecule-level tokens under `molecules.theme_light` and `molecules.theme_dark`.
  - May also include `shorthand.theme_light` and `shorthand.theme_dark` groups for alias/utility tokens.

See the build configuration in `style-dictionary.config.mjs` for how these groups map to outputs and selectors.

### Commands

```
npm run tokens:clean   # remove dist/tokens
npm run tokens:build   # generate CSS variables and JS modules
```

Storybook is wired to build tokens first:

```
npm run storybook       # dev preview at http://localhost:6006
npm run build-storybook # static build in storybook-static/
```

### Build outputs

On build, artifacts are written to `dist/tokens/`:

- CSS variables
  - `primitives.css` → `:root { --primitives-... }`
  - `semantic-light.css` → `.theme-light { --semantics-... }`
  - `semantic-dark.css` → `.theme-dark { --semantics-... }`
  - `molecules-light.css`, `molecules-dark.css`
  - `shorthand-light.css`, `shorthand-dark.css`
- ES modules
  - `primitives.js`, `semantic-light.js`, `semantic-dark.js`
  - `molecules-light.js`, `molecules-dark.js`
  - `shorthand-light.js`, `shorthand-dark.js`

The CSS files scope theme tokens to `.theme-light` and `.theme-dark` to enable runtime theme switching via a class on the root element.

### Using tokens in apps

Include the generated CSS and toggle theme classes:

```html
<link rel="stylesheet" href="/dist/tokens/primitives.css" />
<link rel="stylesheet" href="/dist/tokens/semantic-light.css" />
<link rel="stylesheet" href="/dist/tokens/semantic-dark.css" />

<body class="theme-light">
  <!-- ... -->
</body>
```

Use CSS variables in your styles:

```css
button.primary {
  color: var(--semantics-color-text-primary);
  background: var(--semantics-color-bg-primary);
  border-radius: var(--primitives-radius-md);
}
```

Consume JS tokens when needed (e.g., in JS styling or docs):

```js
import primitives from '../dist/tokens/primitives.js';
import light from '../dist/tokens/semantic-light.js';

console.log(primitives.primitives.color.blue[500]);
console.log(light.semantics.theme_light.color.text.primary);
```

### Token authoring guidelines

- Keep base design decisions in `primitives` only; avoid theme-specific values here.
- Define user-facing, themeable aliases in `semantics.theme_light` and `semantics.theme_dark` with the same structure/keys per theme.
- Use `molecules` for component-level tokens (e.g., button, input) that compose semantic/primitive tokens.
- Optional `shorthand` can expose grouped aliases for ergonomics.
- Prefer referencing with Style Dictionary references (e.g., `{primitives.color.blue.500}`) to keep relationships traceable.

Minimal example:

```json
{
  "primitives": {
    "color": { "blue": { "500": { "value": "#2b6cb0" } } },
    "radius": { "md": { "value": "8px" } }
  },
  "semantics": {
    "theme_light": {
      "color": {
        "bg": { "primary": { "value": "{primitives.color.blue.500}" } },
        "text": { "primary": { "value": "#ffffff" } }
      }
    },
    "theme_dark": {
      "color": {
        "bg": { "primary": { "value": "#1a202c" } },
        "text": { "primary": { "value": "#e2e8f0" } }
      }
    }
  }
}
```

### Token layering: primitives → semantics → molecules

Tokens flow upward through three layers. Use Style Dictionary references (`{group.path.to.token}`) to compose values without duplicating raw values.

| Layer | Example key | Example value/reference | Output CSS var scope |
|---|---|---|---|
| primitives | `primitives.color.blue.500` | `#2b6cb0` | `:root` |
| semantics (light) | `semantics.theme_light.color.bg.primary` | `{primitives.color.blue.500}` | `.theme-light` |
| semantics (dark) | `semantics.theme_dark.color.bg.primary` | `#1a202c` | `.theme-dark` |
| molecules (light) | `molecules.theme_light.button.primary.bg` | `{semantics.theme_light.color.bg.primary}` | `.theme-light` |
| molecules (dark) | `molecules.theme_dark.button.primary.bg` | `{semantics.theme_dark.color.bg.primary}` | `.theme-dark` |

End-to-end mapping example:

| Primitive | Semantic (light) | Molecule (light) |
|---|---|---|
| `primitives.color.blue.500 = #2b6cb0` | `semantics.theme_light.color.bg.primary = {primitives.color.blue.500}` | `molecules.theme_light.button.primary.bg = {semantics.theme_light.color.bg.primary}` |
| `primitives.radius.md = 8px` | `semantics.theme_light.radius.control = {primitives.radius.md}` | `molecules.theme_light.input.radius = {semantics.theme_light.radius.control}` |
| `primitives.color.gray.900 = #0f172a` | `semantics.theme_light.color.text.primary = {primitives.color.gray.900}` | `molecules.theme_light.card.text.primary = {semantics.theme_light.color.text.primary}` |

This layering keeps raw decisions centralized in `primitives`, applies theming in `semantics`, and lets `molecules` assemble component-ready tokens that trace back to the source values.

### Theming

- Light theme styles are scoped to `.theme-light { ... }` and dark theme to `.theme-dark { ... }`.
- Switch themes by toggling a class on your root element. Only one theme class should be present at a time.

```js
const root = document.documentElement;
root.classList.remove('theme-light', 'theme-dark');
root.classList.add('theme-dark');
```

### Configuration

The build is controlled by `style-dictionary.config.mjs`:

- Reads from: `src/tokens/primitive.json`, `src/tokens/semantic.json`, `src/tokens/molecules.json`.
- Emits both CSS (`css/variables`) and JS (`javascript/es6`).
- Applies filters so each file only contains its matching group and theme.
- Sets `:root` for primitives and theme classes for theme-specific outputs.

Adjust file lists, selectors, or add new platforms (e.g., TS, Android, iOS) in that config as needed.

### Storybook

Storybook showcases tokens from `dist/tokens/`. It builds tokens automatically before starting:

```
npm run storybook
```

Relevant stories live under `src/stories/` (e.g., `Tokens.stories.jsx`, `PrimitivesTokens.stories.jsx`, `SemanticTokens.stories.jsx`, `MoleculesTokens.stories.jsx`).

### Project layout

```
src/
  tokens/
    primitive.json
    semantic.json
    molecules.json
dist/
  tokens/
    primitives.css | .js
    semantic-light.css | .js
    semantic-dark.css  | .js
    molecules-light.css | .js
    molecules-dark.css  | .js
    shorthand-light.css | .js
    shorthand-dark.css  | .js
```

### Clean and rebuild

```
npm run tokens:clean && npm run tokens:build
```

---

This app was bootstrapped with Create React App for convenience, but the token pipeline is framework-agnostic and can be consumed by any web project.
